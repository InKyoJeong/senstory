{"version":3,"file":"../pages/related.js","mappings":"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","sources":["webpack://scenery-book-front/./pages/related.tsx","webpack://scenery-book-front/external \"@ant-design/icons\"","webpack://scenery-book-front/external \"antd\"","webpack://scenery-book-front/external \"axios\"","webpack://scenery-book-front/external \"dayjs\"","webpack://scenery-book-front/external \"dayjs/locale/ko\"","webpack://scenery-book-front/external \"dayjs/plugin/relativeTime\"","webpack://scenery-book-front/external \"immer\"","webpack://scenery-book-front/external \"next-redux-wrapper\"","webpack://scenery-book-front/external \"next/dist/server/denormalize-page-path.js\"","webpack://scenery-book-front/external \"next/dist/server/image-config.js\"","webpack://scenery-book-front/external \"next/dist/shared/lib/head.js\"","webpack://scenery-book-front/external \"next/dist/shared/lib/i18n/normalize-locale-path.js\"","webpack://scenery-book-front/external \"next/dist/shared/lib/mitt.js\"","webpack://scenery-book-front/external \"next/dist/shared/lib/router-context.js\"","webpack://scenery-book-front/external \"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\"","webpack://scenery-book-front/external \"next/dist/shared/lib/router/utils/is-dynamic.js\"","webpack://scenery-book-front/external \"next/dist/shared/lib/router/utils/parse-relative-url.js\"","webpack://scenery-book-front/external \"next/dist/shared/lib/router/utils/querystring.js\"","webpack://scenery-book-front/external \"next/dist/shared/lib/router/utils/route-matcher.js\"","webpack://scenery-book-front/external \"next/dist/shared/lib/router/utils/route-regex.js\"","webpack://scenery-book-front/external \"next/dist/shared/lib/to-base-64.js\"","webpack://scenery-book-front/external \"next/dist/shared/lib/utils.js\"","webpack://scenery-book-front/external \"next/router\"","webpack://scenery-book-front/external \"react\"","webpack://scenery-book-front/external \"react-copy-to-clipboard\"","webpack://scenery-book-front/external \"react-intersection-observer\"","webpack://scenery-book-front/external \"react-redux\"","webpack://scenery-book-front/external \"react-slick\"","webpack://scenery-book-front/external \"react/jsx-runtime\"","webpack://scenery-book-front/external \"redux\"","webpack://scenery-book-front/external \"redux-devtools-extension\"","webpack://scenery-book-front/external \"redux-saga\"","webpack://scenery-book-front/external \"redux-saga/effects\"","webpack://scenery-book-front/external \"styled-components\""],"sourcesContent":["import React, { useEffect, useMemo } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useInView } from 'react-intersection-observer';\nimport axios from 'axios';\nimport Router from 'next/router';\nimport wrapper from '../store/configureStore';\nimport { END } from 'redux-saga';\nimport { loadMeRequest } from '../reducers/user/loadMe';\nimport { randomUserRequest } from '../reducers/user/randomUser';\nimport { loadRelatedPostRequest } from '../reducers/post/loadRelatedPost';\nimport { RootState } from '../reducers';\nimport { GetServerSideProps } from 'next';\n\nimport Layout from '../components/common/Layout';\nimport PostCard from '../components/post/PostCard';\nimport Loader from '../components/common/Loader';\nimport Conditional from '../hocs/Conditional';\n\nconst Related = () => {\n  const dispatch = useDispatch();\n  const { me } = useSelector((state: RootState) => state.user);\n  const { mainPosts, hasMorePosts, loadRelatedPostsLoading, repostError } = useSelector(\n    (state: RootState) => state.post,\n  );\n  const [ref, inView] = useInView();\n\n  useEffect(() => {\n    if (repostError) {\n      alert(repostError);\n    }\n  }, [repostError]);\n\n  useEffect(() => {\n    if (inView && hasMorePosts && !loadRelatedPostsLoading) {\n      const lastId = mainPosts[mainPosts.length - 1]?.id;\n\n      dispatch(loadRelatedPostRequest(lastId));\n    }\n  }, [inView, hasMorePosts, loadRelatedPostsLoading, mainPosts]);\n\n  useEffect(() => {\n    if (!(me && me.id)) {\n      Router.push('/login');\n    }\n  }, [me && me.id]);\n\n  if (!me) {\n    return <Loader text=\"로그인 페이지로 이동중...\" />;\n  }\n\n  const emptyStyle = useMemo(\n    () => ({\n      color: 'white',\n      display: 'flex',\n      justifyContent: 'center',\n      marginTop: '50%',\n    }),\n    [],\n  );\n\n  return (\n    <Layout related>\n      <Conditional condition={mainPosts.length === 0}>\n        <div style={emptyStyle}>표시할 게시물이 없습니다.</div>\n      </Conditional>\n\n      {mainPosts.map((post) => (\n        <PostCard key={post.id} post={post} ref={hasMorePosts && !loadRelatedPostsLoading ? ref : undefined} />\n      ))}\n    </Layout>\n  );\n};\n\nexport const getServerSideProps: GetServerSideProps = wrapper.getServerSideProps(\n  (store): any =>\n    async ({ req }: any) => {\n      const cookie = req ? req.headers.cookie : '';\n      axios.defaults.headers.Cookie = '';\n      if (req && cookie) {\n        axios.defaults.headers.Cookie = cookie;\n      }\n\n      store.dispatch(loadMeRequest());\n      store.dispatch(loadRelatedPostRequest());\n      store.dispatch(randomUserRequest());\n      store.dispatch(END);\n      await store.sagaTask.toPromise();\n    },\n);\n\nexport default Related;\n","module.exports = require(\"@ant-design/icons\");","module.exports = require(\"antd\");","module.exports = require(\"axios\");","module.exports = require(\"dayjs\");","module.exports = require(\"dayjs/locale/ko\");","module.exports = require(\"dayjs/plugin/relativeTime\");","module.exports = require(\"immer\");","module.exports = require(\"next-redux-wrapper\");","module.exports = require(\"next/dist/server/denormalize-page-path.js\");","module.exports = require(\"next/dist/server/image-config.js\");","module.exports = require(\"next/dist/shared/lib/head.js\");","module.exports = require(\"next/dist/shared/lib/i18n/normalize-locale-path.js\");","module.exports = require(\"next/dist/shared/lib/mitt.js\");","module.exports = require(\"next/dist/shared/lib/router-context.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/is-dynamic.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/parse-relative-url.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/querystring.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-matcher.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-regex.js\");","module.exports = require(\"next/dist/shared/lib/to-base-64.js\");","module.exports = require(\"next/dist/shared/lib/utils.js\");","module.exports = require(\"next/router\");","module.exports = require(\"react\");","module.exports = require(\"react-copy-to-clipboard\");","module.exports = require(\"react-intersection-observer\");","module.exports = require(\"react-redux\");","module.exports = require(\"react-slick\");","module.exports = require(\"react/jsx-runtime\");","module.exports = require(\"redux\");","module.exports = require(\"redux-devtools-extension\");","module.exports = require(\"redux-saga\");","module.exports = require(\"redux-saga/effects\");","module.exports = require(\"styled-components\");"],"names":["React","useEffect","useMemo","useSelector","useDispatch","useInView","axios","Router","wrapper","END","loadMeRequest","randomUserRequest","loadRelatedPostRequest","Layout","PostCard","Loader","Conditional","Related","dispatch","me","state","user","mainPosts","hasMorePosts","loadRelatedPostsLoading","repostError","post","ref","inView","alert","lastId","length","id","push","emptyStyle","color","display","justifyContent","marginTop","map","undefined","getServerSideProps","store","req","cookie","headers","defaults","Cookie","sagaTask","toPromise"],"sourceRoot":""}